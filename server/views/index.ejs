<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Feature Flag</title>


    <link rel="stylesheet" href="/main.css">
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
    <script src='/main.js'></script>
</head>
<body class="container">
<main>
    <div class='title'>
        <h1>Feature Flags</h1>
        <button type="button" class="btn btn-primary">
            <i class='fa-solid fa-plus'></i>
            <span>New</span>
        </button>
    </div>

    <table class='table table-bordered'>
        <thead>
        <tr>
            <th>Name</th>
            <th>Description</th>
            <th class='column-100'>Enabled</th>
            <th class='column-200 text-right'>Updated At</th>
            <th class='column-100 text-center'>Actions</th>
        </tr>
        </thead>
        <tbody id='flags'>

        </tbody>
    </table>
</main>

<script>
  const data = `<%= JSON.stringify(flags) %>`;
  const str = data.replaceAll('&#34;', '"');
  const flags = JSON.parse(str);
  const allFlags = [];
  flags.sort((a, b) => a.enabled ? -1 : 1).forEach(flag => {
    allFlags.push(`
        <tr data-row='${flag.id}'>
            <td>${flag.name}</td>
            <td>${flag.description}</td>
            <td class='text-center'>
              <i class='fa-solid fa-check fa-lg ${flag.enabled ? '' : 'notEnabled'}'></i>
            </td>
            <td class='text-right'>${formatDate(flag.updatedAt)}</td>
            <td style='display: flex; column-gap: 16px;'>
                <button class='icon' onclick='deleteFlag(${flag.id})'>
                  <i class='fa-solid fa-xmark fa-xl'></i>
                </button>
                <button class='icon' onclick='toggleFlag(${flag.id})'>
                  <i class='fa-solid fa-rotate fa-lg'></i>
                </button>
            </td>
        </tr>
    `);
  });

  document.getElementById('flags').innerHTML = allFlags.join('')
</script>
</body>
</html>